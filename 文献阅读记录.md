推荐系统

流程：准备数据 、选 择 算法、模型训练、效果评估等

传统推荐算法：

![image-20240104155950984](C:\Users\Asus\AppData\Roaming\Typora\typora-user-images\image-20240104155950984.png)

基于深度学习的推荐算法主要围绕在提升表征学习能力、深度协同过滤、充分利用特征三个层面。



# 文献阅读记录







#### 方向

sar与光学图像融合

#### 分类

1. 多模图像融合：多个传感器捕获的有用信息整合到单幅的融合图像中，以实现对场景有效且全面地表征。

   红外和可见光图像融合、医学图像融合。

2. 数字摄影图像融合：将不同设置下拍摄的图像进行融合，并生成高动态范围、全聚焦的融合图像。

   多曝光图像融合、多聚焦图像融合。

3. 和遥感影像融合：遥感影像融合旨在将空间分辨率和光谱分辨率不同的图像进行融合，得到一幅高空间分辨率和高光谱分辨率兼备的融合图像。

   多光谱与全色图像融合

4. 通用图像融合

#### 类型

- 传统方法：在空间域或变换域( 通过某种数学变换将图像转换至变换域) 执行活动水平测量并手动设计融合规则来实现图像融合。
  1. 括基于多尺度变换的融合框架
  2. 基于稀疏表示的融合框架
  3. 基于子空间的融合框架
  4. 基于显著性的融合框架
  5. 基于变分模型的融合框架

局限性：

 	1. 没考虑不同源图像存在本质差异
 	2. 手工设计的活动水平测量和融合规则无法适应复杂的融合场景，而且为了追求更好的融合性能，活动水平测量和融合规则的设计变得越来越复杂

- 深度学习：特征提取、特征融合和图像重建

1. 基于自编码器的图像融合框架
2. 基于卷积神经网络的图像融合框架
3. 基于生成对抗网络的图像融合框架 。

根据训练过程中使用的监督范式，基于深度学习的图像融合算法还可分为无监督图像融合框架、自监督图像融合框架和有监督图像融合框架。

创新：数据集，一个新数据集的提出，为了解决的新的问题，弥补之前的gap



### 论文笔记

[数字图像处理(4): 遥感影像中 光谱分辨率、空间分辨率、时间分辨率、全色图像、多光谱图像、高光谱图像 的区别_全色分辨率和多光谱分辨率-CSDN博客](https://blog.csdn.net/zaishuiyifangxym/article/details/89461704)

[了解景深 这一篇就够了 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/55740729#:~:text=什么是景深 当你拍摄一个照片，照片当中最近的物体和最远的物体之间，能清晰成像的部分，就是景深。,当然，这部分是逐渐发生的，也就是说由不清晰到清晰的一个范围。 比如上面两张示意图，图片中清晰的部分就是景深。)

动态范围越大，就能尽可能的保留这些高光区和阴影区的信息

动态范围”是一个用于定义相机可以在多大范围内捕捉图像的影调细节的术语，通常指由最低值到最高溢出值之间的范围。简单地说，它描述的是相机在单帧内可以记录的最亮和最暗影调之间的比率。

当你拍摄的图像在光线上有巨大的差异时，更大的动态范围就能获得更大的影调空间——例如一个有明亮窗户和昏暗内部的地点。来自窗户的光线比墙壁内部的光线要亮得多，如果动态范围不够大，这时要么窗户的光线太亮，曝光过度（看起来是白色的），要么墙壁太暗，曝光不足（看起来是黑色的），这会导致图像失去细节。下面是类似场景的示例。







1. Efficient(PEFT)：大模型微调
2. 选择新的研究方向
3. 通用的，即插即用的模块，选择很多baseline，在自己能承受的范围
4. 私有数据集领域



#### 瞬时视场


​	"瞬时视场"（Instantaneous Field of View，IFOV）是指传感器或探测器在某一时刻测量或感知的视野范围。具体来说，IFOV表示在给定的时间点上，传感器能够覆盖或测量的地面或目标区域的大小。

​	IFOV通常以角度表示，是指在某一瞬时时刻，传感器从其位置所能观察到的视场的角度范围。较小的IFOV表示传感器能够更精细地测量或观察到小尺度的目标或特征，而较大的IFOV则表示传感器在同一时刻能够涵盖更大的地面区域。

​	对于一些遥感或传感器技术，IFOV是一个重要的参数，因为它影响到传感器的分辨率和能够检测到的目标大小。IFOV越小，传感器就具有更高的空间分辨率，能够捕捉到更小的地物或目标。IFOV的大小通常由传感器的设计和技术规格决定。



#### 端元和丰度

在遥感和遥感图像处理领域，"端元"（endmember）和"丰度"（abundance）是两个重要的概念，通常用于混合像元分析，特别是在高光谱图像处理中。

1. **端元（Endmember）：**
   - **定义：** 端元是指图像中的纯净光谱或光谱特征，代表了图像中的一种地物或材料。端元可以看作是图像中的极端点，对应于单一地物或材料的光谱特征。
   - **例子：** 如果一副高光谱图像包含植被、土壤和水体，那么每一种地物对应一个端元，其光谱特征分别表示植被、土壤和水体的光谱。
2. **丰度（Abundance）：**
   - **定义：** 丰度表示一个像素中包含不同端元的程度，即每个端元在该像素中的相对贡献或占比。丰度是一个与每个端元关联的系数，用于描述像素中各种端元的混合程度。
   - **例子：** 如果一个像素同时包含植被、土壤和水体，丰度表示了每个端元在该像素中的权重。例如，一个像素的植被丰度可能是0.6，土壤丰度是0.3，水体丰度是0.1。

混合像元分析的目标是从复杂的高光谱数据中提取出每个地物或材料的端元和它们在每个像素中的丰度。这种分析对于地物分类、环境监测和资源管理等应



### 研究趋势

多光谱与全色图像融合的研究趋于瓶颈，不同融合方法的性能差异在视觉上已经难以区分，而全色与高光谱图像融合、多光谱与高光谱图像融合的研究仍有较大发展空间。尤其是实验中使用的全色与高光谱融合数据、多光谱与高光谱融合数据多是通过对真实高光谱图像进行空间下采样或是光谱下采样的方式生成，采用真实卫星获取的多光谱、高光谱图像进行数据融合的研究工作较少。

全色、多光谱和高光谱图像的融合研究是领域内的热点，但如何将图像融合算法与实际应用问题相结合仍存在诸多问题。从应用的角度改进融合算法的性能和效率，增加融合算法的实用性，是多源遥感图像空谱融合的挑战难题，也是其未来的发展趋势。用非常重要。



## 数据集

#### CAVE dataset

- **数量：** 32 个室内场景的 HSI
- **尺寸：**HSI 每个波段的大小为 512 × 512 像素
- **波长：**波长范围覆盖 400 nm 至 700 nm，包含 31 个波段

#### Harvard dataset

- **数量：**50 个室内和室外场景的 HSI，具有日光照明下的各种物体
- **尺寸：**HSI 每个波段的大小为 1040 × 1392 像素
- **波长：**波长范围覆盖 420 nm 至 720 nm，包含 31 个波段

#### WDCM dataset

- **数量：**1 张 Hydice 传感器于 1995 年在华盛顿特区国家广场上空捕获的遥感 HSI
- **尺寸：**HSI 每个波段的大小为 1280 × 307 个像素，空间分辨率为 2.5 m

- **波长：**波长范围覆盖 400 nm 至 2400 nm，包含 191 个波段

#### YRE dataset

- **数量：**
  - **HSI：**1 张 GaoFen-5 卫星的高光谱成像仪（AHSI）捕获的遥感 HSI
  - **MSI：**1 张 Sentinel-2 A 卫星上的多光谱成像仪（MSI）捕获的遥感 MSI
- **尺寸：**
  - **HSI：**HSI 每个波段的大小为 1400 × 1400 像素，空间分辨率为 30 m
  - **MSI：**MSI 每个波段的大小为 4200 × 4200 像素，空间分辨率为 10 m
- **波长：**
  - **HSI：**波长范围覆盖 400 nm 至 2500 nm，包含 280 个波段
  - **MSI：**波长范围覆盖 430 nm 至 680 nm，包含 4 个波段

### 关键字

Hyperspectral and Multispectral Image Fusion

### 综述

Recent advances and new guidelines on hyperspectral and multispectral image fusion. 1区 



Multispectral and hyperspectral image fusion in remote sensing A survey, Information Fusion

InformationFusion （1区top） IF 18.6

Gemine Vivone



## Image fusion meets deep learning: A survey and perspective

> Hao Zhang,Han Xu,Xin Tian,Junjun Jiang,Jiayi Ma；1区/Q1；Information Fusion；2021

### 1. 引言

- **图像融合：**旨在将不同源图像中的互补信息整合到单幅融合图像中以全面表征成像场景，并促进后续的视觉任务。

- **背景：**由于成像设备硬件限制，单一类型或单一设置下的传感器通常无法全面地表征成像场景。
- 传统融合方法：采用相关的数学变换，在空间域或变换域中手动分析活动水平并设计融合规则
  - 经典方法：基于多尺度变换的方法、基于稀疏表示的方法、基于子空间的方法、基于显着性的方法、基于全变分的方法等
  - 局限性：
    - 为了保证后续特征融合的可行性，传统方法采用相同的变换对不同的源图像提取特征。没有考虑源图像的特征差异，可能导致提取的特征表现较差
    - 传统的特征融合策略过于粗糙，融合性能非常有限

![image-20240204002313172](C:\Users\Asus\AppData\Roaming\Typora\typora-user-images\image-20240204002313172.png)

- 基于深度学习的融合方法：旨在弥补传统融合方法的局限性
  - 任务：特征提取、特征融合、图像重建
  - 分类：
    - 基于自编码器（AE）：AE 方法通常预先训练自编码器，然后使用训练好的自编码器实现特征提取和图像重建，使用传统融合策略实现中间特征融合
    - 基于卷积神经网络（CNN）：
      - 利用精心设计的损失函数和网络结构来实现端到端的特征提取、特征融合和图像重建
      - 采用经过训练的CNN来制定融合规则，而特征提取和图像重建则使用传统方法
    - 基于生成对抗网络（GAN）：GAN方法依靠生成器和判别器之间的对抗博弈来估计目标的概率分布，可以以隐式方式联合完成特征提取、特征融合和图像重建
  - 优势：
    - 可以利用不同的网络分支来实现差异化的特征提取，从而获得更有针对性的特征
    - 可以在精心设计的损失函数的指导下学习更合理的特征融合策略，从而实现自适应特征融合



- 三类图像融合场景
  - 数字摄影图像融合
  - 多模态图像融合
  - 锐化融合



- 数字摄影图像融合：将不同设置下拍摄的图像进行融合，并生成高动态范围、全聚焦的融合图像

  - 多曝光图像融合：CNN和GAN方法
  - 多聚焦图像融合：CNN和GAN方法，也分为基于决策图和基于整体重建的深度学习方法

- 多模态图像融合：将多个传感器获得的图像中最重要的信息结合起来，实现对场景的有效描述

  - 红外和可见光图像融合：AE、CNN和GAN方法
  - 医学图像融合：CNN和GAN方法

- 锐化融合：融合不同空间/光谱分辨率的图像以获得同时具有高空间分辨率和高光谱分辨率的图像。 

  - 多光谱锐化：LR-MSI + PAN => HR-MSI
    - 有监督方法：通过低通滤波器、下采样等方式，对原始 MSI 和 PAN 图像进行空间退化操作，获得 LR-MSI 和 LR-PAN 作为输入图像，原始 MSI 作为参考图像
      - CNN方法：生成的 HR-MSI 图像与参考图像之间的像素强度距离是监督 CNN 训练网络的主要约束
        - 局限性：仅在这种约束下获得的融合结果往往具有空间结构损失
        - 改进：采用新的学习策略、增加额外的损失函数
      - GAN方法：直接使用参考图像作为对抗目标，从而同时实现所需光谱分布和空间结构分布的估计
        - 局限性：融合性能较无监督更好，但高度依赖于配对数据的构造
    - 无监督方法：直接在原始 MSI 和 PAN 图像上进行训练
      - CNN方法：通过构造损失函数更好的保留光谱和空间结构。光谱损失通常是空间退化后融合图像与原 LR-MSI 之间的距离，空间损失通常是变换后 PAN 图像与融合 HR-MSI 之间的强度/梯度距离
      - GAN方法：使用两个独立的判别器来实现光谱和空间结构的保留
        - 局限性：融合性能较有监督更差，用于构造空间结构损失的设计不够合理，限制了无监督模型的性能

  - 高光谱锐化：LR-HSI + PAN/MSI => HR-HSI，CNN和GAN方法
    - 有监督方法：通过光谱响应函数（SRF）和自定义点扩散函数（PSF）对原始 HSI 进行光谱退化和空间退化。退化图像和原始 HSI 被构建成图像对，实现有监督光谱锐化
      - 局限性：在模拟数据上训练获得的模型可能并不适合真实场景
    - 无监督方法：通过 SRF 和 PSF 在生成的 HR-HSI 与源图像之间建立一致性关系 ，从而实现对 HR-HSI 的有效估计
      - 局限性：SRF 和 PSF 在大多数情况下是不可知的

- 通用图像融合：要点是找到不同融合任务间的共性



- **三类图像融合场景：**

  - **多模图像融合**
    - **特点：**多模图像融合能够将多个传感器捕获的有用信息整合到单幅的融合图像中，以实现对场景有效且全面地表征。
    - **任务：**红外和可见光图像融合、医学图像融合。

  - **数字摄影图像融合**
    - **特点：**数字摄影图像融合能够将不同设置下拍摄的图像进行融合，并生成高动态范围、全聚焦的融合图像。
    - **任务：**多曝光图像融合、多聚焦图像融合。
  - **遥感影像融合**
    - **特点：**遥感影像融合旨在将空间分辨率和光谱分辨率不同的图像进行融合，得到一幅高空间分辨率和高光谱分辨率兼备的融合图像。
    - **任务：**多光谱与全色图像融合

  > 从源图像的成像角度来看，遥感影像融合也属于多模图像融合。但是遥感影像融合相较于多模图像融合需要更高的空间和光谱保真度来提升分辨率。



## Multiscale spatial–spectral transformer network for hyperspectral and multispectral image fusion

> Sen Jia,Zhichao Min,Xiyou Fu；1区/Q1；Information Fusion；18.6；2023

### 1 引言

- 背景：由于卷积核的感受野有限，基于卷积神经网络（CNN）的融合方法无法利用特征图中的全局关系。

- 创新：
  1. 提出了一种基于 Transformer 的多尺度空-谱变换网络（MSST-Net），其包含两个分支网络，分别提取 HSI 的光谱特征和 MSI 的空间特征
  2. 提出了光谱变换器（ SpeT ）提取光谱特征，空间变换器（SpaT）提取空间特征
  3. 引入多尺度波段/块嵌入，通过 SpeT 和 SpaT 获得多尺度特征
  4. 提出了一种自监督预训练策略，并专门设计了一个掩码图像块自编码器（MBAE）和一个掩码光谱波段自编码器（MPAE）用于 SpeTs 和 SpaTs 的自监督预训练

- 实现思路：观测到的 LR-HSI 和 HR-MSI 可分别视为底层 HR-HSI 的空间和光谱退化版本。因此，可以利用观测到的图像重建底层 HR-HSI。
- 重建底层 HR-HSI 的两种方法：
  - 单一 LR-HSI 超分辨率
    - 缺点：由于图像重建是一个假定问题，因此仅从单一 LR-HSI 恢复 HR-HSI 非常棘手
  - LR-HSI 与 HR-MSI 或全色图像融合（主流）

- 基于机器学习的方法（eg. 矩阵分解的方法、基于张量分解的方法）
  - 不足：这些方法大多依赖于人工设计的先验，耗时长且表征能力有限

- 基于卷积神经网络（CNN）的方法
  - 不足：由于 CNN 的感受野较小，无法有效捕捉全局特征，在一定程度上限制了融合性能

- 基于Transformer的方法（eg. ViT）
  - 优点：能够捕捉全局特征
  - 不足（本文改进）：
    - 限制了其对不同尺度空间特征的表征能力
    - 限制了其对高光谱图像光谱特征的提取能力
    - 需要更多的训练数据才能获得较好的效果

- 本文方法（MSST-Net）：创新见上文

### 2 网络架构

#### 2.1 MSST-Net 网络架构

![image-20240201232410303](C:\Users\Asus\AppData\Roaming\Typora\typora-user-images\image-20240201232410303.png)

- $y ∈ R^{h \times w \times S}$ 表示观测到的 LR-HSI；$z ∈ R^{H \times W \times s}$ 表示观测到的 HR-MSI
- 使用双线性插值法，对 $y$ 进行上采样得到 $y_{up} ∈ R^{H \times W \times S}$；对 $z$ 进行下采样得到 $z_{down} ∈ R^{h \times w \times s}$
- 跨模态串联（通道维），连接 $y$ 和 $z_{down}$ 得到 $y_cat ∈ R^{ℎ \times 𝑤 \times (𝑆+𝑠)}$，连接 $z$ 和 $y_{up}$ 得到 $z_{cat} ∈ R^{H \times W \times (𝑆+𝑠)}$
- 浅层特征提取（SFE），使用卷积核大小 $=3$，通道数 $C=64$，步长 $=1$ 的二维卷积组成有5个残差块的残差网络分别对 $y_{cat}$ 和 $z_{cat}$ 进行浅层特征提取得到 $F_s ∈ R^{ℎ \times 𝑤 \times C}$ 与 $F_{s}^{`} ∈ R^{H \times W \times C}$
- 多尺度深度特征提取——光谱特征，深度光谱特征提取模块（DSpeFE）$L$ 的数量 $=3$，每个 DSpeFE 包含 $1$ 个波段嵌入层（并添加位置嵌入）、$J=5$ 个 SpeT 和 $1$ 个 SFE 中使用的卷积层。$F_s$ 经每个 DSeFE 变换得到深度特征 $F_{l}^{spe} ∈ R^{ℎ \times 𝑤 \times C}$，使用可学习权重聚合提取的多尺度特征，获得 $F_{sum}^{spe} ∈ R^{ℎ \times 𝑤 \times C}$
- 多尺度深度特征提取——空间特征，深度空间特征提取模块（DSpaFE）$L$ 的数量 $=3$，每个 DSpaFE 包含 $1$ 个图像块嵌入层（并添加位置嵌入）、$K=5$ 个 SpaT 和 $1$ 个 SFE 中使用的卷积层。$F_{s}^{`}$ 经每个 DSpaFE 变换得到深度特征 $F_{l}^{spa} ∈ R^{H \times W \times C}$，使用可学习权重聚合提取的多尺度特征，获得 $F_{sum}^{spa} ∈ R^{H \times W \times C}$
- 聚合浅层和深层特征，使用长跳跃连接，聚合 $F_s$ 和 $F_{sum}^{spe}$ 获得光谱特征 $F^{spe} ∈ R^{ℎ \times 𝑤 \times C}$，聚合 $F_{s}^{`}$ 和 $F_{sum}^{spa}$ 获得空间特征 $F^{spa} ∈ R^{H \times W \times C}$
- 对 $F^{spe}$ 上采样得到 $F_{up}^{spe} ∈ R^{H \times W \times C}$，并串联 $F_{up}^{spe}$ 和 $F^{spa}$ 得到空-谱特征 $F ∈ R^{H \times W \times 2C}$
- 将空-谱特征 $F$ 输入图像重建模块以获得估计的 HR-HSI $X^` ∈ R^{H \times W \times S}$
- $Loss = || X^`-X||$，其中$X ∈ R^{H \times W \times S}$ 为真实HR-HSI

#### 2.2 预训练网络

##### 2.2.1 MPAE架构（extend MAE）

![image-20240202184902040](C:\Users\Asus\AppData\Roaming\Typora\typora-user-images\image-20240202184902040.png)

- 移除了 MAE 的类标记，并提出了一种掩码 patch 自编码器（MPAE）
- 将 MPAE 设置为对称编码器-解码器结构，并将屏蔽的 patch 设置为可学习标记
- 通过编码器保留已经学习到 HR - MSI 的空间特征的 patch 嵌入，用于后续的微调。
- 实验数据集的 HR-MSI 掩码率设置为 50%

##### 2.2.2 MBAE架构

![image-20240202205459365](C:\Users\Asus\AppData\Roaming\Typora\typora-user-images\image-20240202205459365.png)

- 提出了一种掩码光谱波段自编码器（MBAE）从 LR-HSI 中获取光谱特征
- MBAE具有对称的编码器-解码器结构，并随机屏蔽输入图像的一些波段，然后使用解码器重建屏蔽的光谱波段
-  MBAE 通过从输入 HR-MSI 的未被屏蔽的波段重建随机屏蔽波段来预训练网络
- 实验数据集的 LR-HSI 掩码率设置为 75%

### 3 实验

#### 3.1 数据集

- CAVE、Harvard、WDCM、YRE

- 对 CAVE、Harvard 和 WDCM 数据集的 HR-HSI 应用高斯滤波器，以生成模糊的 HSI。然后，我们通过分别以 4 和 8 的比率对模糊 HSI 进行下采样来生成 LR-HSI
- 对 CAVE 和 Harvard 数据集，使用 Nikon D700 给定的光谱响应矩阵生成具有三个波段的 HR-MSI
- 对 WDCM 数据集，使用 Sentinel-2 A 仪器的光谱响应矩阵生成具有 10 个波段的 HR-MSI 
- 对 YRE 数据集，对 HSI 和 MSI 进行 3 倍下采样后生成训练样本

#### 3.2 实验方案

- 首先将 HR-MSI 输入 MPAE，将 LR-HSI 输入 MBAE 进行自监督预训练，然后将两个预训练编码器的参数加载到所提出的网络中进行端到端微调
- 仅使用 CAVE 数据集对网络进行预训练，然后分别使用 CAVE 数据集和哈佛数据集对网络进行微调

- 评价指标：
  - 降低分辨率下重建的 HR-HSI 的质量：PSNR、SAM、SSIM、ERGAS、RMSE
  - 全分辨率实验：QNR、HQNR

### 结论

​	与其他最先进的方法相比，MSST-Net 可以获得优异的性能。然而，所提出的网络适用于配准良好的图像对的融合。如果图像之间存在较大的错位，该网络可能无法工作。因此，在未来的研究中，应重点关注通过引入一些正则化来约束两种模式的表示来扩展网络，使其能够处理配准良好和未配准的情况

